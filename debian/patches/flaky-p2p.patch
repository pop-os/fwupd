diff --git a/data/tests/fwupdmgr-p2p.sh b/data/tests/fwupdmgr-p2p.sh
index b4d5d94aa..a317636d5 100755
--- a/data/tests/fwupdmgr-p2p.sh
+++ b/data/tests/fwupdmgr-p2p.sh
@@ -3,6 +3,8 @@ set -e
 
 exec 2>&1
 
+if [ -z "$(DEB_ALLOW_FLAKY_TESTS)" ]; then exit 0; fi
+
 # only run as root, possibly only in CI
 if [ "$(id -u)" -ne 0 ]; then exit 0; fi
 
