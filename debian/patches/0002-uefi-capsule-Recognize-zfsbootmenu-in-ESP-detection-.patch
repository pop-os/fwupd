From 4159a22c943f8793dcb7cb042f849accfcdfed98 Mon Sep 17 00:00:00 2001
From: Mario Limonciello <superm1@gmail.com>
Date: Fri, 22 Mar 2024 08:27:00 -0500
Subject: [PATCH 2/3] uefi-capsule: Recognize zfsbootmenu in ESP detection
 heuristic

Fixes: https://github.com/fwupd/fwupd/issues/6956
(cherry picked from commit 506cd1c86e6ea49d987e159e1593da289537d9f0)
---
 plugins/uefi-capsule/fu-uefi-capsule-plugin.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/plugins/uefi-capsule/fu-uefi-capsule-plugin.c b/plugins/uefi-capsule/fu-uefi-capsule-plugin.c
index 1a107b2ff..3921a5b1e 100644
--- a/plugins/uefi-capsule/fu-uefi-capsule-plugin.c
+++ b/plugins/uefi-capsule/fu-uefi-capsule-plugin.c
@@ -540,7 +540,7 @@ fu_uefi_capsule_plugin_load_config(FuPlugin *plugin, FuDevice *device)
 static gboolean
 fu_uefi_capsule_plugin_is_esp_linux(FuVolume *esp, GError **error)
 {
-	const gchar *prefixes[] = {"grub", "shim", "systemd-boot", NULL};
+	const gchar *prefixes[] = {"grub", "shim", "systemd-boot", "zfsbootmenu", NULL};
 	g_autofree gchar *prefixes_str = NULL;
 	g_autofree gchar *mount_point = fu_volume_get_mount_point(esp);
 	g_autoptr(GPtrArray) files = NULL;
-- 
2.34.1

